<main class="container">
    <section class="main-panel">
            <div class="col-sm-12 product-details-content">
                <div class="content-pane" id="edit-product-content">
                    <% if(typeof(messages.success) !== 'undefined') { %>
                    <div id="main-alert-success" class="alert alert-success alert-dismissible fade show" role="alert">
                        <%= messages.success %>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    </div>
                    <% } %>
                    <% if(typeof(messages.info) !== 'undefined') { %>
                    <div id="main-alert-info" class="alert alert-primary alert-dismissible fade show" role="alert">
                        <%= messages.info %>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    </div>
                    <% } %>
                    <% if(typeof(messages.error) !== 'undefined') { %>
                    <div id="main-alert" class="alert alert-danger alert-dismissible fade show" role="alert">
                        <%= messages.error %>
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                    </div>
                    <% } %>
                    <div>
                        <span class="edit-heading-span">
                            <h2><%= shop.displayName %></h2>
                            <a href="<% if(typeof(ref) == 'string' && ref.length > 0) { %><%= ref %><% } else { %>/market/shops<% } %>">
                                <button class="btn btn-primary spc-left-1">Back to Shops</button>
                            </a>
                        </span>
                        <hr>
                    </div>
                    <% if(typeof(shop.images) !== 'undefined' && Array.isArray(shop.images) && shop.images.length > 0) { %>
                    <figure class="featured-image shop-hero">
                        <% if(typeof(shop.images[0]) !== 'undefined') { %>
                        <img id="product-hero-img" src="<% if(shop.images[0].src) { %><%= shop.images[0].src %><% } %>">
                        <% } else { %>
                        <%- include('assets/symbols/shop.svg') %>
                        <% } %>
                    </figure>
                    <% if(shop.images.length > 1) { %>
                    <div class="product-carousel-images-row">
                        <% for (let imgIdx=0;imgIdx<shop.images.length;imgIdx++) { %>
                        <figure class="featured-mini-image <% if(imgIdx == 0) { %>featured-mini-image-selected<% } %>">
                            <% if(typeof(shop.images[0]) !== 'undefined') { %>
                            <img class="product-image" src="<% if(shop.images[imgIdx].src) { %><%= shop.images[imgIdx].src %><% } %>">
                            <% } else { %>
                            <%- include('assets/symbols/shop.svg') %>
                            <% } %>
                        </figure>
                        <% } %>
                    </div>
                    <% } %>
                    <% } else { %>
                    <figure class="featured-image shop-hero">
                        <%- include('assets/symbols/shop.svg') %>
                    </figure>
                    <% } %>
                    <p class="featured-image-legend shop-hero-legend">Shop Images</p>
                    <div class="row">
                        <div id="product-images-carousel" class="product-carousel col-sm-6">
                            <% if (typeof(shop.addresses) !== 'undefined' && Array.isArray(shop.addresses) && shop.addresses.length > 0 ) { %>
                                <%
                                    let addr = generator.getPrimaryField(shop.addresses)
                                    if(!addr) addr = shop.addresses[0]

                                    let pn = generator.getPrimaryField(shop.phoneNumbers)
                                 %> 
                                <table class="table table-striped table-hover product-specifications-table">
                                    <thead>
                                        <tr>
                                            <th scope="row" colspan="2">Contact Information</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th scope="row">Address</th>
                                            <td>
                                                <div class="table-content"><% if(addr) { %><%= addr.formatted %><% }%></div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Phone Number</th>
                                            <td>
                                                <div class="table-content"><% if(pn && typeof(pn.value) !== 'undefined') { %><%= pn.value %><% }%></div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            <% } %>
                        </div>
                        <div class="col-sm-6">
                            <div class="product-view-card-pane">
                                <span>
                                    <div class="item-card product-details-card">
                                        <div class="item-card-right extra-info">
                                            <h4>Description</h4>
                                            <p><%= shop.description %></p>
                                            <h4>Status</h4>
                                            <p>
                                                <%= shop.status %>
                                            </p>
                                        </div>
                                    </div>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </section>
</main>
<script>
    (() => {
        let shopImgs = document.getElementsByClassName('product-image')
        for (const img of shopImgs) {
            img.addEventListener('click',() => {
                let shopHero = document.getElementById('product-hero-img')
                if(shopHero) {
                    let shopImageFigs = document.getElementsByClassName('featured-mini-image')

                    if(shopImageFigs) {
                        for (const i of shopImageFigs) {
                            i.classList.remove('featured-mini-image-selected')
                        }
                    }
                    img.parentElement.classList.add('featured-mini-image-selected')
                    shopHero.src = img.src
                }
            })
        }
    })()
</script>